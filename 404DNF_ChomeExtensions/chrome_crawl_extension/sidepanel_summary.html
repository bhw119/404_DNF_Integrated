<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>DARKPATTERN DETECTION</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    /* ===== 색/타이포 기본값: 라이트(흰 배경) 강제 ===== */
    :root {
      color-scheme: light;
      --bg:#ffffff; --fg:#111827; --muted:#6b7280; --line:#e5e7eb;
      --accent:#3b82f6; --danger:#ef4444;

      /* ▶ 게이지 색(동적) – 기본은 '위험' 빨강 */
      --risk-rgb: 239,68,68;

      /* 상단 아이콘 버튼 */
      --btn-bg:#f3f4f6;
      --btn-br:#d1d5db;
      --btn-fg:#111827;
      --btn-hov:#e5e7eb;
      --focus:#93c5fd;

      /* 분석 카드 연회색 배경 */
      --card-soft:#f3f4f6;

      /* TOP3 카드 색 */
      --rank-primary:#2563eb;      /* 파랑 */
      --rank-primary-soft:#dbeafe; /* 연파랑 */
      --rank-silver:#f3f4f6;       /* 은색 느낌 배경 */
      --rank-text-light:#e5edff;   /* 파랑카드 안의 연한 텍스트 */
    }

    * { box-sizing:border-box }
    html,body {
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--fg); background:var(--bg);
    }

    /* ===== Header ===== */
    header { position:sticky; top:0; background:var(--bg); z-index:10; border-bottom:1px solid var(--line); }
    .topbar { display:flex; align-items:center; gap:8px; padding:12px 14px; }
    .title { font-weight:800; letter-spacing:.3px; font-size:16px; }

    /* 아이콘 버튼 */
    .actions { margin-left:auto; display:flex; gap:8px; }
    .iconbtn {
      width:30px; height:30px; display:grid; place-items:center; border-radius:8px;
      border:1px solid var(--btn-br); background:var(--btn-bg); color:var(--btn-fg);
      cursor:pointer; transition:background .15s ease, box-shadow .15s ease, transform .02s;
      box-shadow:0 1px 0 rgba(0,0,0,.03);
    }
    .iconbtn:hover { background:var(--btn-hov); box-shadow:0 1px 4px rgba(0,0,0,.08); }
    .iconbtn:active { transform:translateY(1px); }
    .iconbtn:focus-visible { outline:2px solid var(--focus); outline-offset:2px; }
    .iconbtn svg { width:16px; height:16px; stroke:currentColor; stroke-width:2; fill:none; stroke-linecap:round; stroke-linejoin:round; }

    /* 스크린리더용 상태 텍스트 */
    .sr-only { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }

    /* ===== Tabs ===== */
    .tabs { display:flex; gap:12px; padding:0 14px 10px; border-bottom:1px solid var(--line); }
    .tab {
      background:transparent; border:0; cursor:pointer;
      display:flex; align-items:center; gap:8px;
      padding:10px 8px; border-bottom:2px solid transparent;
      color:#6b7280; font-size:13px;
    }
    .tab:hover { color:var(--fg); }
    .tab.active { color:var(--fg); font-weight:700; border-bottom-color: var(--accent); }
    .tab svg { width:18px; height:18px; opacity:.9; stroke:var(--fg); fill:none; stroke-width:2; stroke-linecap:round; stroke-linejoin:round; }

    /* ===== 공통 레이아웃/카드 ===== */
    .wrap { padding:14px; display:grid; gap:14px; }
    .card {
      border:1px solid var(--line); border-radius:14px; padding:14px; display:grid; gap:10px;
      background:#ffffff; box-shadow:0 1px 4px rgba(0,0,0,.06);
    }
    .section-title { font-weight:800; font-size:15px; }
    .muted { color:var(--muted); font-size:12px; }
    .divider { height:1px; background:var(--line); margin:4px 0; }

    /* ===== 요약 배너/게이지 ===== */
    .banner { border-radius:12px; padding:12px; background:#f8fafc; border:1px solid var(--line); }
    .banner strong { display:block; font-weight:800; margin-bottom:6px; }
    .risk-title { font-size:20px; font-weight:900; color: #000; line-height: 1.25; }
    .risk-legend { display:flex; gap:16px; align-items:center; font-size:12px; }
    .risk-legend span { color:#6b7280; display:inline-flex; align-items:center; gap:6px; transition:color .2s ease, font-weight .2s ease; }
    .legend-dot {
      width:10px; height:10px; border-radius:50%;
      background:#e5e7eb; display:inline-block;
      transition:transform .15s ease, background .2s ease, box-shadow .2s ease, opacity .2s ease;
      opacity:.9;
    }
    .risk-legend span.active { color:#111827; font-weight:800; }
    .risk-legend span.active .legend-dot {
      background: rgb(var(--risk-rgb));
      transform: scale(1.15);
      box-shadow:
        0 0 0 4px rgba(var(--risk-rgb), .14),
        0 0 10px rgba(var(--risk-rgb), .35);
      opacity:1;
    }
    
    .risk-legend span:nth-child(1) .legend-dot{ background:#10b981 } /* 안전-초록 */
    .risk-legend span:nth-child(2) .legend-dot{ background:#6366f1 } /* 주의-보라 */
    .risk-legend span:nth-child(3) .legend-dot{ background:#f59e0b } /* 경고-주황 */
    .risk-legend span:nth-child(4) .legend-dot{ background:#ef4444 } /* 위험-빨강 */
    

    /* .legend-dot { width:8px; height:8px; border-radius:50%; background:var(--line); display:inline-block; vertical-align:middle; margin-right:6px; }
    .legend-danger { background:var(--danger) } */
    .rings { display:grid; place-items:center; width:240px; height:240px; margin:10px auto 0; }
    .ring { border-radius:50%; display:grid; place-items:center; }
    .ring.r1 { width:240px; height:240px;background:radial-gradient(circle at center, rgba(var(--risk-rgb), .10) 0 60%, transparent 61% 100%);}
    .ring.r2 { width:180px; height:180px;background:radial-gradient(circle at center, rgba(var(--risk-rgb), .18) 0 60%, transparent 61% 100%);}
    .ring.r3 { width:120px; height:120px;background:radial-gradient(circle at center, rgba(var(--risk-rgb), .28) 0 60%, transparent 61% 100%);}
    .ring-center {width:92px; height:92px; border-radius:50%; background:#fff;box-shadow:0 0 0 10px rgba(var(--risk-rgb), .12) inset;display:grid; place-items:center; text-align:center;}
    .ring-center b { display:block; font-size:12px; color: rgb(var(--risk-rgb)); }
    .ring-center .big { font-size:22px; font-weight:900; }

    /* ===== 분석(버킷) ===== */
    .subtle { color:var(--muted); font-size:12px; display:flex; gap:14px; align-items:center; }
    .grid { display:grid; gap:10px; grid-template-columns:repeat(2,1fr); }
    .metric { border:1px solid var(--line); border-radius:12px; padding:12px; background:#fff; }
    .metric.soft { background:var(--card-soft); border-color:transparent; }
    .metric .name { font-size:12px; color:var(--muted); margin-bottom:6px; }
    .metric .val { font-weight:900; font-size:20px; display:flex; align-items:baseline; gap:4px; }
    .metric .unit { font-size:14px; font-weight:700; }
    .metric .outof { font-size:12px; color:var(--muted); }

    /* ===== TOP3 다크패턴 유형 카드 ===== */
    .rank-wrap { display:grid; gap:10px; }
    .rank-card {
      position:relative; border-radius:14px; padding:14px;
      display:flex; align-items:center; justify-content:space-between;
      border:1px solid var(--line); background:var(--rank-silver);
    }
    .rank-card.primary {
      background:var(--rank-primary);
      color:white; border-color:transparent;
    }
    .rank-left { display:grid; gap:4px; }
    .rank-title { font-weight:800; font-size:18px; }
    .rank-sub { font-size:12px; opacity:.9; }
    .primary .rank-sub { color:var(--rank-text-light); }
    .rank-right { font-weight:900; font-size:22px; display:flex; gap:4px; align-items:baseline; }
    .rank-badge {
      position: absolute;
      left: -4px;      
      top: -7px;      
      right: auto;      
      width: 48px;
      height: 48px;
      display: grid;
      place-items: center;
      z-index: 5;
    }

    /* 메달 이미지 */
    .rank-badge img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      display: block;
    }

    /* 텍스트와 겹치지 않게 왼쪽 여백 확보 */
    .rank-card.primary {
      padding-left: 60px;
    }
    .rank-card.secondary { background:var(--rank-silver); }

    /* ===== 링크 카드===== */
    .link-block { padding:0; overflow:hidden; }
    /* 전체 클릭 영역 */
    .link-head {
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; padding:16px 14px;
      text-decoration:none; color:inherit; background:#fff;
      border-bottom:1px solid var(--line);
    }
    .link-head:focus-visible { outline:2px solid var(--focus); outline-offset:-2px; }
    .link-head:hover { background:#f9fafb; }
    .kicker { color:var(--muted); font-size:13px; margin-bottom:6px; }
    .headline { font-weight:900; font-size:22px; letter-spacing:-0.2px; }
    .chev { width:24px; height:24px; stroke:currentColor; fill:none; stroke-width:2; stroke-linecap:round; stroke-linejoin:round; opacity:.8; }

    /* 정보 푸터*/
    .project-card {
      background:#0f172a;
      color:#e5e7eb;
      padding:18px 16px;
      display:grid; gap:10px;
      border-top:0;
      border-bottom-left-radius:14px;
      border-bottom-right-radius:14px;
    }
    .project-title { font-weight:800; font-size:20px; color:#fff; }
    .row { display:flex; gap:12px; align-items:center; font-size:14px; color:#e5e7eb; }
    .project-card .muted { color:#94a3b8; font-size:13px; min-width:64px; }

    /* 툴 배지 */
    .tools { display:flex; gap:10px; margin-top:2px; flex-wrap:wrap; }
    .pill {
      display:inline-flex; align-items:center; justify-content:center;
      height:34px; min-width:34px; padding:0 12px;
      border-radius:999px; background:#111827; border:1px solid #1f2937; color:#e5e7eb;
      font-weight:700; font-size:13px;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,0.04);
    }
  </style>
</head>
<body>  
  <!-- ===== Header ===== -->
  <header>
    <div class="topbar">
      <div class="title">DARKPATTERN DETECTION</div>

      <!-- 오른쪽: 새로고침 / 닫기 -->
      <div class="actions">
        <button id="actionRefresh" class="iconbtn" title="다시 불러오기" aria-label="다시 불러오기">
          <svg viewBox="0 0 24 24"><path d="M21 12a9 9 0 1 1-3-6.7M21 3v6h-6"/></svg>
        </button>
        <button id="actionClose" class="iconbtn" title="닫기" aria-label="닫기">
          <svg viewBox="0 0 24 24"><path d="M6 6l12 12M18 6l-12 12"/></svg>
        </button>
      </div>
    </div>

    <!-- 탭 -->
    <div class="tabs">
      <button class="tab active" data-to="summary" aria-controls="summary" aria-selected="true">
        <svg viewBox="0 0 24 24"><path d="M12 3l2 4 4 2-4 2-2 4-2-4-4-2 4-2z"/></svg>
        <span>요약</span>
      </button>
      <button class="tab" id="tabAnalysis" data-to="analysis" aria-controls="analysis" aria-selected="false">
        <svg viewBox="0 0 24 24"><path d="M3 3v18M21 21H3M7 17V9m5 8V5m5 12v-6"/></svg>
        <span>분석</span>
      </button>
    </div>

    <!-- 스크린리더용 상태 -->
    <div id="status" class="sr-only" aria-live="polite">불러오는 중…</div>
  </header>

  <!-- ===== Main ===== -->
  <main class="wrap">
    <!-- 요약 -->
    <section id="summary" class="card">
      <div class="banner">
        <strong>해당 페이지에서 다크패턴이 탐지되었습니다.</strong>
        <div class="muted">다크패턴 분석은 문장 단위로 진행되며, 화면에서 다크패턴 요소를 찾아볼 수 있습니다.</div>
      </div>

      <div class="row" style="margin-top:8px;">
        <span class="risk-title">전체 다크패턴 위험 지수 <span id="overallRiskText">100%</span></span>
      </div>
      <div id="riskLegend" class="risk-legend">
        <span data-label="안전"><span class="legend-dot"></span>안전</span>
        <span data-label="주의"><span class="legend-dot"></span>주의</span>
        <span data-label="경고"><span class="legend-dot"></span>경고</span>
        <span data-label="위험"><span class="legend-dot"></span>위험</span>
      </div>

      <div class="rings" aria-hidden="true">
        <div class="ring r1"><div class="ring r2"><div class="ring r3">
          <div class="ring-center">
            <b>위험</b>
            <div class="big" id="overallRiskValue">76%</div>
          </div>
        </div></div></div>
      </div>
    </section>

    <!-- 분석 (버킷) -->
    <section id="analysis" class="card">
      <div class="section-title">분석 결과</div>
      <div style="font-weight:800; font-size:14px;">다크패턴 가능성</div>
      <div class="subtle">
        • 높음 100~71%  • 중간 70~31%  • 낮음 30~1%  • 해당안됨 0%
      </div>

      <div class="grid">
        <div class="metric soft">
          <div class="name">높음</div>
          <div class="val"><span id="highCount">12</span><span class="unit">개</span><span class="outof" id="highOutOf">/100</span></div>
        </div>
        <div class="metric soft">
          <div class="name">중간</div>
          <div class="val"><span id="midCount">7</span><span class="unit">개</span><span class="outof" id="midOutOf">/100</span></div>
        </div>
        <div class="metric soft">
          <div class="name">낮음</div>
          <div class="val"><span id="lowCount">6</span><span class="unit">개</span><span class="outof" id="lowOutOf">/100</span></div>
        </div>
        <div class="metric soft">
          <div class="name">해당안됨</div>
          <div class="val"><span id="noneCount">5</span><span class="unit">개</span><span class="outof" id="noneOutOf">/100</span></div>
        </div>
      </div>
    </section>

    <!-- TOP3 카드로 사용 -->
    <section id="law" class="card">
      <div class="section-title">가장 많은 다크패턴 유형</div>
      <div style="font-weight:800; font-size:14px;">분석 TOP3</div>

      <div class="rank-wrap">
        <!-- 1위 -->
        <div class="rank-card primary" id="rank1Card">
          <div class="rank-badge medal">
            <img src="medal.png" alt="1위 메달" style="width: 34px; height: 34px;">
          </div>
          <div class="rank-left">
            <div class="rank-title" id="top1Name">-</div>
            <div class="rank-sub" id="top1Desc">-</div>
          </div>
          <div class="rank-right"><span id="top1Count">0</span><span>개</span></div>
        </div>
        <!-- 2위 -->
        <div class="rank-card secondary" id="rank2Card">
          <div class="rank-left">
            <div class="rank-sub">TOP2</div>
            <div class="rank-title" id="top2Name">-</div>
            <div class="rank-sub" id="top2Desc">-</div>
          </div>
          <div class="rank-right"><span id="top2Count">0</span><span>개</span></div>
        </div>
        <!-- 3위 -->
        <div class="rank-card secondary" id="rank3Card">
          <div class="rank-left">
            <div class="rank-sub">TOP3</div>
            <div class="rank-title" id="top3Name">-</div>
            <div class="rank-sub" id="top3Desc">-</div>
          </div>
          <div class="rank-right"><span id="top3Count">0</span><span>개</span></div>
        </div>
      </div>
    </section>

    <!-- 웹사이트 이동 · 간격/디자인 수정 -->
    <section class="card link-block">
      <a class="link-head" href="https://github.com/404DNF" target="_blank" rel="noopener noreferrer">
        <div>
          <div class="kicker">웹사이트 이동</div>
          <div class="headline">다크패턴이 궁금하다면?</div>
        </div>
        <svg class="chev" viewBox="0 0 24 24" aria-hidden="true"><path d="M9 6l6 6-6 6"/></svg>
      </a>

      <div class="project-card">
        <div class="project-title">404 DNF</div>

        <div class="row">
          <span class="muted">project</span>
          <span>Neuro Symbolic AI를 활용한 다크패턴 탐지 서비스</span>
        </div>

        <div class="row">
          <span class="muted">period</span>
          <span>2025.03 - 2025.11</span>
        </div>
      </div>
    </section>
  </main>
  </main>

  <!-- 메인 스크립트 -->
  <script src="sidepanel_summary.js"></script>
</body>
</html>
